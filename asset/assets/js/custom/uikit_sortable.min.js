!function(t){var e;window.UIkit&&(e=t(UIkit)),"function"==typeof define&&define.amd&&define("uikit-sortable",["uikit"],function(){return e||t(UIkit)})}(function(t){"use strict";function e(e){e=t.$(e);do{if(e.data("sortable"))return e;e=t.$(e).parent()}while(e.length);return e}function o(t,e){var o=t.parentNode;if(e.parentNode!=o)return!1;for(var s=t.previousSibling;s&&9!==s.nodeType;){if(s===e)return!0;s=s.previousSibling}return!1}function s(t,e){var o=e;if(o==t)return null;for(;o;){if(o.parentNode===t)return o;if(!(o=o.parentNode)||!o.ownerDocument||11===o.nodeType)break}return null}function a(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.returnValue=!1}var n,r,i,l,h,d,u,c,p,g,f=["touchmove","mousemove","mouseout"],m=["touchmove","mousemove"],v=["touchstart","mousedown"];return t.component("sortable",{defaults:{animation:150,threshold:10,childClass:"uk-sortable-item",placeholderClass:"uk-sortable-placeholder",overClass:"uk-sortable-over",draggingClass:"uk-sortable-dragged",dragMovingClass:"uk-sortable-moving",baseClass:"uk-sortable",noDragClass:"uk-sortable-nodrag",emptyClass:"uk-sortable-empty",dragCustomClass:"",handleClass:!1,group:!1,stop:function(){},start:function(){},change:function(){}},boot:function(){t.ready(function(e){t.$("[data-uk-sortable]",e).each(function(){var e=t.$(this);e.data("sortable")||t.sortable(e,t.Utils.options(e.attr("data-uk-sortable")))})}),t.$html.on("mousemove touchmove",function(e){if(u){var o=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0]:e;(Math.abs(o.pageX-u.pos.x)>u.threshold||Math.abs(o.pageY-u.pos.y)>u.threshold)&&u.apply(o)}if(n){h||(h=!0,n.show(),n.$current.addClass(n.$sortable.options.placeholderClass),n.$sortable.element.children().addClass(n.$sortable.options.childClass),t.$html.addClass(n.$sortable.options.dragMovingClass));var s=n.data("mouse-offset"),a=parseInt(e.originalEvent.touches&&e.originalEvent.touches[0]?e.originalEvent.touches[0].pageX:e.originalEvent.pageX,10)+s.left,r=parseInt(e.originalEvent.touches&&e.originalEvent.touches[0]?e.originalEvent.touches[0].pageY:e.originalEvent.pageY,10)+s.top;if(n.css({left:a,top:r}),r+n.height()/3>document.body.offsetHeight)return;r<t.$win.scrollTop()?t.$win.scrollTop(t.$win.scrollTop()-Math.ceil(n.height()/3)):r+n.height()/3>window.innerHeight+t.$win.scrollTop()&&t.$win.scrollTop(t.$win.scrollTop()+Math.ceil(n.height()/3))}}),t.$html.on("mouseup touchend",function(t){if(u=d=!1,r&&n){var o=e(r),s=n.$sortable,a={type:t.type};o[0]&&s.dragDrop(a,s.element),s.dragEnd(a,s.element)}else r=n=null})},init:function(){function e(t){r&&n.dragMove(t,n)}function o(e){return function(o){var a,r,i;o&&(r=(a=o.touches&&o.touches[0]||{}).target||o.target,o.touches&&o.touches[0]&&document.elementFromPoint&&(r=document.elementFromPoint(a.pageX-document.body.scrollLeft,a.pageY-document.body.scrollTop)),g=t.$(r)),t.$(r).hasClass(n.options.childClass)?e.apply(r,[o]):r!==l&&(i=s(l,r))&&e.apply(i,[o])}}var n=this,l=this.element[0];c=[],this.checkEmptyList(),this.element.data("sortable-group",this.options.group?this.options.group:t.Utils.uid("sortable-group"));var h=o(function(e){if(!e.data||!e.data.sortable){var o=t.$(e.target),s=o.is("a[href]")?o:o.parents("a[href]");if(!o.is(":input"))return e.preventDefault(),!e.touches&&s.length&&s.one("click",function(t){t.preventDefault()}).one("mouseup",function(){p||s.trigger("click")}),e.data=e.data||{},e.data.sortable=l,n.dragStart(e,this)}}),d=(o(t.Utils.debounce(function(t){return n.dragEnter(t,this)})),o(function(e){var o=n.dragenterData(this);n.dragenterData(this,o-1),n.dragenterData(this)||(t.$(this).removeClass(n.options.overClass),n.dragenterData(this,!1))}),o(function(t){return!r||r===this||i===this||(n.element.children().removeClass(n.options.overClass),i=this,n.moveElementNextTo(r,this),a(t))}));this.addDragHandlers=function(){f.forEach(function(t){l.addEventListener(t,d,!1)})},this.removeDragHandlers=function(){f.forEach(function(t){l.removeEventListener(t,d,!1)})},m.forEach(function(t){window.addEventListener(t,e,!1)}),v.forEach(function(t){l.addEventListener(t,h,!1)})},dragStart:function(e,o){p=!1,h=!1,l=!1;var s=this,a=t.$(e.target);if((e.touches||2!=e.button)&&(!s.options.handleClass||(a.hasClass(s.options.handleClass)?a:a.closest("."+s.options.handleClass,s.element)).length)&&!a.is("."+s.options.noDragClass)&&!a.closest("."+s.options.noDragClass).length&&!a.is(":input")){r=o,n&&n.remove();var i=t.$(r),d=i.offset();u={pos:{x:e.touches&&e.touches[0]?e.touches[0].pageX:e.pageX,y:e.touches&&e.touches[0]?e.touches[0].pageY:e.pageY},threshold:s.options.threshold,apply:function(e){(n=t.$('<div class="'+[s.options.draggingClass,s.options.dragCustomClass].join(" ")+'"></div>').css({display:"none",top:d.top,left:d.left,width:i.width(),height:i.height(),padding:i.css("padding")}).data({"mouse-offset":{left:d.left-parseInt(e.pageX,10),top:d.top-parseInt(e.pageY,10)},origin:s.element,index:i.index()}).append(i.html()).appendTo("body")).$current=i,n.$sortable=s,i.data({"start-list":i.parent(),"start-index":i.index(),"sortable-group":s.options.group}),s.addDragHandlers(),s.options.start(this,r),s.trigger("start.uk.sortable",[s,r]),p=!0,u=!1}}}},dragMove:function(e,o){var s,a=e.touches&&e.touches[0]?e.touches[0].pageX:e.pageX,n=e.touches&&e.touches[0]?e.touches[0].pageY:e.pageY,i=(g=t.$(document.elementFromPoint(a-(document.body.scrollLeft||document.scrollLeft||0),n-(document.body.scrollTop||document.documentElement.scrollTop||0)))).closest("."+this.options.baseClass),l=i.data("sortable-group"),h=t.$(r),d=h.parent(),u=h.data("sortable-group");i[0]!==d[0]&&void 0!==u&&l===u&&(i.data("sortable").addDragHandlers(),c.push(i),i.children().addClass(this.options.childClass),i.children().length>0?(s=g.closest("."+this.options.childClass)).length?s.before(h):i.append(h):g.append(h),UIkit.$doc.trigger("mouseover")),this.checkEmptyList(),this.checkEmptyList(d)},dragEnter:function(e,o){if(!r||r===o)return!0;var s=this.dragenterData(o);if(this.dragenterData(o,s+1),0===s){var a=t.$(o).parent(),n=t.$(r).data("start-list");if(a[0]!==n[0]){var i=a.data("sortable-group"),l=t.$(r).data("sortable-group");if((i||l)&&i!=l)return!1}t.$(o).addClass(this.options.overClass),this.moveElementNextTo(r,o)}return!1},dragEnd:function(e,o){var s=this;r&&(this.options.stop(o),this.trigger("stop.uk.sortable",[this])),r=null,i=null,c.push(this.element),c.forEach(function(e,o){t.$(e).children().each(function(){1===this.nodeType&&(t.$(this).removeClass(s.options.overClass).removeClass(s.options.placeholderClass).removeClass(s.options.childClass),s.dragenterData(this,!1))})}),c=[],t.$html.removeClass(this.options.dragMovingClass),this.removeDragHandlers(),n&&(n.remove(),n=null)},dragDrop:function(t,e){"drop"===t.type&&(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()),this.triggerChangeEvents()},triggerChangeEvents:function(){if(r){var e=t.$(r),o=n.data("origin"),s=e.closest("."+this.options.baseClass),a=[],i=t.$(r);o[0]===s[0]&&n.data("index")!=e.index()?a.push({sortable:this,mode:"moved"}):o[0]!=s[0]&&a.push({sortable:t.$(s).data("sortable"),mode:"added"},{sortable:t.$(o).data("sortable"),mode:"removed"}),a.forEach(function(t,e){t.sortable&&t.sortable.element.trigger("change.uk.sortable",[t.sortable,i,t.mode])})}},dragenterData:function(e,o){if(e=t.$(e),1==arguments.length)return parseInt(e.data("child-dragenter"),10)||0;o?e.data("child-dragenter",Math.max(0,o)):e.removeData("child-dragenter")},moveElementNextTo:function(e,s){l=!0;var a=this,n=t.$(e).parent().css("min-height",""),r=o(e,s)?s:s.nextSibling,i=n.children(),h=i.length;if(!a.options.animation)return s.parentNode.insertBefore(e,r),void t.Utils.checkDisplay(a.element.parent());n.css("min-height",n.height()),i.stop().each(function(){var e=t.$(this),o=e.position();o.width=e.width(),e.data("offset-before",o)}),s.parentNode.insertBefore(e,r),t.Utils.checkDisplay(a.element.parent()),(i=n.children().each(function(){var e=t.$(this);e.data("offset-after",e.position())}).each(function(){var e=t.$(this),o=e.data("offset-before");e.css({position:"absolute",top:o.top,left:o.left,"min-width":o.width})})).each(function(){var e=t.$(this),o=(e.data("offset-before"),e.data("offset-after"));e.css("pointer-events","none").width(),setTimeout(function(){e.animate({top:o.top,left:o.left},a.options.animation,function(){e.css({position:"",top:"",left:"","min-width":"","pointer-events":""}).removeClass(a.options.overClass).removeData("child-dragenter"),--h||(n.css("min-height",""),t.Utils.checkDisplay(a.element.parent()))})},0)})},serialize:function(){var e,o,s=[];return this.element.children().each(function(a,n){e={};for(var r=0;r<n.attributes.length;r++)0===(o=n.attributes[r]).name.indexOf("data-")&&(e[o.name.substr(5)]=t.Utils.str2json(o.value));s.push(e)}),s},checkEmptyList:function(e){e=e?t.$(e):this.element,this.options.emptyClass&&e[e.children().length?"removeClass":"addClass"](this.options.emptyClass)}}),t.sortable});